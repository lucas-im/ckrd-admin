import{J as h,a0 as z,g as y,U as R,p as I,y as U,r as b,x as p,S as D,bN as E,bH as F,q as T,w as f,s as i,t as S,v as V,X as L}from"./index.53601f29.js";import{f as w,g as q}from"./rule.bb7c6a80.js";import{u as G}from"./useSmsCode.d2e75a58.js";import{_ as H}from"./Input.3bd50f34.js";import{_ as J,b as X}from"./FormItem.57f42bd0.js";import{_ as j}from"./Space.5825aa0a.js";function K(s=152,o=40){const t=h(),u=h("");function d(n){u.value=n}function e(){!t.value||(u.value=O(t.value,s,o))}return z(()=>{e()}),{domRef:t,imgCode:u,setImgCode:d,getImgCode:e}}function r(s,o){return Math.floor(Math.random()*(o-s)+s)}function v(s,o){const t=r(s,o),u=r(s,o),d=r(s,o);return`rgb(${t},${u},${d})`}function O(s,o,t){let u="";const d="0123456789",e=s.getContext("2d");if(!e)return u;e.fillStyle=v(180,230),e.fillRect(0,0,o,t);for(let n=0;n<4;n+=1){const c=d[r(0,d.length)];u+=c;const l=r(18,41),m=r(-30,30);e.font=`${l}px Simhei`,e.textBaseline="top",e.fillStyle=v(80,150),e.save(),e.translate(30*n+23,15),e.rotate(m*Math.PI/180),e.fillText(c,-15+5,-15),e.restore()}for(let n=0;n<5;n+=1)e.beginPath(),e.moveTo(r(0,o),r(0,t)),e.lineTo(r(0,o),r(0,t)),e.strokeStyle=v(180,230),e.closePath(),e.stroke();for(let n=0;n<41;n+=1)e.beginPath(),e.arc(r(0,o),r(0,t),1,0,2*Math.PI),e.closePath(),e.fillStyle=v(150,200),e.fill();return u}const Q=y({name:"ImageVerify"}),W=y({...Q,props:{code:{default:""}},emits:["update:code"],setup(s,{expose:o,emit:t}){const u=s,{domRef:d,imgCode:e,setImgCode:n,getImgCode:c}=K();return R(()=>u.code,l=>{n(l)}),R(e,l=>{t("update:code",l)}),o({getImgCode:c}),(l,m)=>(I(),U("div",null,[b("canvas",{ref_key:"domRef",ref:d,width:"152",height:"40",class:"cursor-pointer",onClick:m[0]||(m[0]=(...B)=>p(c)&&p(c)(...B))},null,512)]))}}),Y={class:"flex-y-center w-full"},Z=b("div",{class:"w-18px"},null,-1),ee={class:"pl-8px"},oe=S(" \u786E\u5B9A "),te=S("\u8FD4\u56DE"),ie=y({__name:"index",setup(s){const o=D(),{toLoginModule:t}=E(),{label:u,isCounting:d,loading:e,getSmsCode:n}=G(),c=h(null),l=F({phone:"",code:"",imgCode:""}),m=h(""),B={phone:w.phone,code:w.code,imgCode:q(m)};function A(){n(l.phone)}function $(k){!c.value||(k.preventDefault(),c.value.validate(a=>{var g,C;a?(C=window.$message)==null||C.error("\u9A8C\u8BC1\u5931\u8D25"):(g=window.$message)==null||g.success("\u9A8C\u8BC1\u901A\u8FC7!")}))}return(k,a)=>{const g=H,C=J,x=L,M=W,N=j,P=X;return I(),T(P,{ref_key:"formRef",ref:c,model:l,rules:B,size:"large","show-label":!1},{default:f(()=>[i(C,{path:"phone"},{default:f(()=>[i(g,{value:l.phone,"onUpdate:value":a[0]||(a[0]=_=>l.phone=_),placeholder:"\u624B\u673A\u53F7\u7801"},null,8,["value"])]),_:1}),i(C,{path:"code"},{default:f(()=>[b("div",Y,[i(g,{value:l.code,"onUpdate:value":a[1]||(a[1]=_=>l.code=_),placeholder:"\u9A8C\u8BC1\u7801"},null,8,["value"]),Z,i(x,{size:"large",disabled:p(d),loading:p(e),onClick:A},{default:f(()=>[S(V(p(u)),1)]),_:1},8,["disabled","loading"])])]),_:1}),i(C,{path:"imgCode"},{default:f(()=>[i(g,{value:l.imgCode,"onUpdate:value":a[2]||(a[2]=_=>l.imgCode=_),placeholder:"\u9A8C\u8BC1\u7801,\u70B9\u51FB\u56FE\u7247\u5237\u65B0"},null,8,["value"]),b("div",ee,[i(M,{code:m.value,"onUpdate:code":a[3]||(a[3]=_=>m.value=_)},null,8,["code"])])]),_:1}),i(N,{vertical:!0,size:18},{default:f(()=>[i(x,{type:"primary",size:"large",block:!0,round:!0,loading:p(o).loginLoading,onClick:$},{default:f(()=>[oe]),_:1},8,["loading"]),i(x,{size:"large",block:!0,round:!0,onClick:a[4]||(a[4]=_=>p(t)("pwd-login"))},{default:f(()=>[te]),_:1})]),_:1})]),_:1},8,["model"])}}});export{ie as _};
